<!-- ------------------------------------------------------------------------------------------------------------
     ------------------------------------- INICIO perfil_docente .HTML ------------------------------------------
     ------------------------------------------------------------------------------------------------------------ -->

{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Perfil Docente</title>
  <link rel="icon" type="image/png" href="{% static 'assets/imagenes/logo1.png' %}">
  <link rel="stylesheet" href="{% static 'assets/css/perfil_docente.css' %}">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<!--TITULO BODY-->
<body>

    <!-- TITULO BARRA LATERAL -->
      
        <nav class="sidebar">
          <div class="profile text-center p-3">
            {% if foto %}
              <img src="data:image/jpeg;base64,{{ foto }}" alt="Perfil">
            {% else %}
              <img src="https://i.pinimg.com/736x/f6/d5/b4/f6d5b458bf7aa0276c81a666c916de18.jpg" alt="Perfil">
            {% endif %}
            <h5 class="text-white">{{ nombre }} {{ apellido }}</h5>
          </div>
          <ul class="nav flex-column">
            <li><a href="{% url 'InicioDocente' %}" class="nav-link {% if request.resolver_match.url_name == 'InicioDocente' %}active{% endif %}"><i class="fas fa-home me-2"></i>Inicio</a></li>
            <li><a href="{% url 'PerfilDocente' %}" class="nav-link {% if request.resolver_match.url_name == 'PerfilDocente' %}active{% endif %}"><i class="fas fa-user-tie me-2"></i>Perfil</a></li>
            <li><a href="{% url 'RetroalimentacionDocente' %}" class="nav-link {% if request.resolver_match.url_name == 'RetroalimentacionDocente' %}active{% endif %}"><i class="fas fa-comments me-2"></i>Retroalimentación</a></li>
            <li>
            <a href="#" id="btnCerrarSesion" class="nav-link text-white">
              <i class="fas fa-right-to-bracket me-2"></i>Salir
            </a>
          </li>
          </ul>
        </nav>

    <!--TITULO PERFIL-->     

        <div class="content">
          <div class="topbar"><h4>Perfil Docente</h4></div>

          <div class="card p-4 text-center" style="max-width: 400px; margin: 20px auto;">
            <h5>Información del Docente</h5>
             <!-- FOTO ACTUAL DEL PERFIL -->
            {% if foto %}
              <img src="data:image/jpeg;base64,{{ foto }}" alt="Perfil" id="profileImg" class="profile-change-img mb-3">
            {% else %}
              <img id="profileImg" src="https://i.pinimg.com/736x/f6/d5/b4/f6d5b458bf7aa0276c81a666c916de18.jpg" alt="Perfil" class="profile-change-img mb-3">
            {% endif %}

    <!--TITULO FOTO DE PERFIL-->
            <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="mb-3">
              <label for="fotoPerfilInput" class="btn btn-primary-custom">
                <i class="fas fa-upload"></i> Cambiar Foto
              </label>
              <input type="file" id="fotoPerfilInput" name="foto_perfil" accept="image/*" style="display:none;" onchange="this.form.submit()">
            </div>
          </form>

    <!--TITULO INFORMACION PERSONAL-->

            <ul class="list-group list-group-flush text-start mt-3">
              <li class="list-group-item"><strong>Nombre:</strong> {{ nombre }} {{ apellido }}</li>
              <li class="list-group-item"><strong>Correo:</strong> {{ correo }}</li>
              <li class="list-group-item"><strong>Departamento:</strong> Ciberseguridad</li>
              <li class="list-group-item"><strong>Rol:</strong> Docente</li>
            </ul>
          </div>
        </div>

    <!--TITULO POPUP --> 
  
      <!-- Popup de confirmación -->
      <div id="confirmationPopup">Foto de perfil actualizada con éxito</div>

<!--cerrar sesion -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const btnCerrarSesion = document.getElementById("btnCerrarSesion");

  btnCerrarSesion.addEventListener("click", (e) => {
    e.preventDefault(); // evita la redirección inmediata

    Swal.fire({
      title: "¿Deseas cerrar sesión?",
      text: "Si cierras sesión, deberás volver a iniciar sesión para continuar.",
      icon: "warning",
      showCancelButton: true,
      confirmButtonText: "Sí, cerrar sesión",
      cancelButtonText: "Cancelar",
      confirmButtonColor: "#d33",
      cancelButtonColor: "#6c757d",
      reverseButtons: true,
      allowOutsideClick: false
    }).then((result) => {
      if (result.isConfirmed) {
        // Redirige solo si confirma
        window.location.href = "{% url 'Inicio' %}";
      }
    });
  });
});
</script>

      <!--llamado al js de perfil_docente-->
      <script src="{% static 'assets/js/perfil_docente.js' %}"></script>

      <!--mensajes emergentes-->
    {% if messages %}
      {% for message in messages %}
      <script>
          Swal.fire({
              icon: "{% if message.tags == 'error' %}error{% elif message.tags == 'success' %}success{% elif message.tags == 'warning' %}warning{% else %}info{% endif %}",
              title: "{{ message|escapejs }}",
              confirmButtonText: "Aceptar",
              confirmButtonColor: "#3085d6",
              timer: 4000,
              timerProgressBar: true
          });
      </script>
      {% endfor %}
    {% endif %}

</body>
</html>

<!-- ------------------------------------------------------------------------------------------------------------
     ------------------------------------- FIN perfil_docente .HTML ---------------------------------------------
     ------------------------------------------------------------------------------------------------------------ -->