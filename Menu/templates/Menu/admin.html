{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Administrador</title>

    <link rel="icon" type="image/png" href="{% static 'assets/imagenes/logo1.png' %}">
    <link rel="stylesheet" href="{% static 'assets/css/admin.css' %}">

    <!-- Bootstrap + Icons + SweetAlert -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>

    <!-- SIDEBAR -->
    <nav class="sidebar">
        <div class="profile text-center p-3">
          {% if foto %}
            <img src="data:image/jpeg;base64,{{ foto }}" alt="Perfil">
          {% else %}
            <img src="https://i.pinimg.com/736x/f6/d5/b4/f6d5b458bf7aa0276c81a666c916de18.jpg" alt="Perfil">
          {% endif %}
          <h5 class="text-white">{{ nombre }} {{ apellido }}</h5>
        </div>
        
        <div class="profile text-center p-3">
            <img src="https://i.pinimg.com/736x/f6/d5/b4/f6d5b458bf7aa0276c81a666c916de18.jpg" alt="Perfil">
            <h5 class="text-white">Administrador</h5>
        </div>

        <ul class="nav flex-column">
            <li><a href="{% url 'admin' %}" class="nav-link active"><i class="fas fa-gear me-2"></i>Administración</a></li>
            <li>
                <a href="#" id="btnCerrarSesion" class="nav-link text-white">
                    <i class="fas fa-right-to-bracket me-2"></i>Salir
                </a>
            </li>
        </ul>

    </nav>


    <!-- CONTENIDO CENTRAL -->
    <div class="content">

        <div class="topbar">
            <h3>Panel de Administración</h3>
            <p class="text-muted">Registrar asignaturas para la plataforma</p>
        </div>

        <div class="card p-4 shadow-sm">

            <h5 class="mb-4 fw-bold">Registro de Asignaturas</h5>

            <!-- LISTAS DESPLEGABLES -->
            <div class="row mb-3">

                <!-- UNIVERSIDAD -->
                <div class="col-md-3 mb-3">
                    <label class="form-label">Universidad / Instituto</label>
                    <select id="selectUniversidad" class="form-select">
                        <option value="">Seleccione...</option>
                        <option value="duoc">Duoc UC</option>
                    </select>
                </div>

                <!-- SEDE -->
                <div class="col-md-3 mb-3">
                    <label class="form-label">Sede</label>
                    <select id="selectSede" class="form-select" disabled>
                        <option value="">Seleccione una universidad</option>
                    </select>
                </div>

                <!-- ESCUELA -->
                <div class="col-md-3 mb-3">
                    <label class="form-label">Escuela</label>
                    <select id="selectEscuela" class="form-select" disabled>
                        <option value="">Seleccione una sede</option>
                    </select>
                </div>

                <!-- CARRERA -->
                <div class="col-md-3 mb-3">
                    <label class="form-label">Carrera</label>
                    <select id="selectCarrera" class="form-select" disabled>
                        <option value="">Seleccione una escuela</option>
                    </select>
                </div>

            </div>

            <hr>

            <!-- SUBIR CSV -->
            <div class="row mt-3">

                <div class="col-md-6">
                    <label class="form-label">Subir archivo CSV (asignaturas_inge_informatica.csv)</label>
                    <input type="file" id="csvFile" accept=".csv" class="form-control" disabled>
                </div>

                <div class="col-md-3 d-flex align-items-end">
                    <button class="btn btn-primary w-100" id="btnSubirCSV" disabled>
                        <i class="fas fa-upload me-2"></i>Subir CSV
                    </button>
                </div>

            </div>

        </div>


        <!-- RESULTADOS -->
        <div id="resultadoCarga" class="mt-4"></div>

    </div>

    <!-- Script -->
    <script src="{% static 'assets/js/admin.js' %}"></script>


    <!-- Logout -->
    <script>
    document.addEventListener("DOMContentLoaded", () => {
        document.getElementById("btnCerrarSesion").addEventListener("click", (e) => {
            e.preventDefault();

            Swal.fire({
            title: "¿Deseas cerrar sesión?",
            icon: "warning",
            showCancelButton: true,
            confirmButtonText: "Cerrar sesión",
            cancelButtonText: "Cancelar",
            confirmButtonColor: "#d43939"
            }).then((result) => {
                if (result.isConfirmed) {
                    window.location.href = "{% url 'Inicio' %}";
                }
            });
        });
    });
    </script>

    <!--mensajes emergentes-->
    {% if messages %}
      {% for message in messages %}
      <script>
          Swal.fire({
              icon: "{% if message.tags == 'error' %}error{% elif message.tags == 'success' %}success{% elif message.tags == 'warning' %}warning{% else %}info{% endif %}",
              title: "{{ message|escapejs }}",
              confirmButtonText: "Aceptar",
              confirmButtonColor: "#d1b0e9",
              timer: 4000,
              timerProgressBar: true
          });
      </script>
      {% endfor %}
    {% endif %}

</body>
</html>