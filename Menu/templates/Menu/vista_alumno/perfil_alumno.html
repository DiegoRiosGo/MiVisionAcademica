<!-- ------------------------------------------------------------------------------------------------------------
     ------------------------------------- INICIO perfil_alumno .HTML -------------------------------------------
     ------------------------------------------------------------------------------------------------------------ -->


{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Perfil</title>
  <link rel="icon" type="image/png" href="{% static 'assets/imagenes/logo1.png' %}">
  <link rel="stylesheet" href="{% static 'assets/css/perfil_alumno.css' %}">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<!-- TITULO BODY -->
<body>

    <!-- TITULO BARRA LATERAL -->

      <!--clase de la barra lateral-->
      <nav class="sidebar">
        <div class="profile text-center p-3">
          {% if foto %}
            <img src="{{ foto }}" alt="Perfil">
          {% else %}
            <img src="https://i.pinimg.com/1200x/71/e0/ee/71e0ee7eb86896b2d21afa6f3a8c8a36.jpg" alt="Perfil">
          {% endif %}
          <h5 class="text-white">{{ nombre }} {{ apellido }}</h5>
        </div>
        <ul class="nav flex-column">
          <li><a href="{% url 'inicio_alumno' %}" class="nav-link {% if request.resolver_match.url_name == 'inicio_alumno' %}active{% endif %}"><i class="fas fa-home me-2"></i>Inicio</a></li>
          <li><a href="{% url 'perfil_alumno' %}" class="nav-link {% if request.resolver_match.url_name == 'perfil_alumno' %}active{% endif %}"><i class="fas fa-user me-2"></i>Perfil</a></li>
          <li><a href="{% url 'test_interest_alumno' %}" class="nav-link {% if request.resolver_match.url_name == 'test_interest_alumno' %}active{% endif %}"><i class="fas fa-list-check me-2"></i>Test de Interés</a></li>
          <li><a href="{% url 'informe_alumno' %}" class="nav-link {% if request.resolver_match.url_name == 'informe_alumno' %}active{% endif %}"><i class="fas fa-file-alt me-2"></i>Informes</a></li>
          <li><a href="{% url 'estadisticas_asignatura_alumno' %}" class="nav-link {% if request.resolver_match.url_name == 'estadisticas_asignatura_alumno' %}active{% endif %}"><i class="fas fa-chart-bar me-2"></i>Estadísticas Asignatura</a></li>
          <li><a href="{% url 'Inicio' %}" class="nav-link text-white"><i class="fas fa-right-to-bracket me-2"></i>Salir</a></li>
        </ul>
      </nav>          

    <!--TITULO PERFIL-->   

      <div class="content">
        <div class="topbar">
          <h4>Perfil</h4>
        </div>
        <div class="card p-4 text-center" style="max-width: 400px; margin: 20px auto;">
          <h5>Información del Estudiante</h5>
          <!-- FOTO ACTUAL DEL PERFIL -->
          {% if foto %}
             {% if foto|slice:":4" == "http" %}
                <img src="{{ foto }}" alt="Foto de perfil" class="rounded-circle" width="150">
            {% else %}
                <img src="data:image/jpeg;base64,{{ foto }}" alt="Foto de perfil" class="rounded-circle" width="150">
            {% endif %}
          {% else %}
            <img id="profileImg" src="https://i.pinimg.com/1200x/71/e0/ee/71e0ee7eb86896b2d21afa6f3a8c8a36.jpg" alt="Perfil" class="profile-change-img mb-3">
          {% endif %}
    
    <!--TITULO FOTO DE PERFIL-->

          <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="mb-3">
              <label for="fotoPerfilInput" class="btn btn-primary-custom">
                <i class="fas fa-upload"></i> Cambiar Foto
              </label>
              <input type="file" id="fotoPerfilInput" name="foto_perfil" accept="image/*" style="display:none;" onchange="this.form.submit()">
            </div>
          </form>

    <!--TITULO INFORMACION PERSONAL-->

          <ul class="list-group list-group-flush text-start mt-3">
            <li class="list-group-item"><strong>Nombre:</strong> {{ nombre }} {{ apellido }}</li>
            <li class="list-group-item"><strong>Correo:</strong> {{ correo }}</li>
            <li class="list-group-item"><strong>Curso:</strong> Ingeniería Informática</li>
            <li class="list-group-item"><strong>Rol:</strong> Estudiante</li>
          </ul>
        </div>
      </div>

    <!--TITULO POPUP --> 
  
      <!-- Popup de confirmación -->
      <div id="confirmationPopup">Foto de perfil actualizada con éxito</div>

      <!--llamado al js de perfil_alumno-->
      <script src="{% static 'assets/js/perfil_alumno.js' %}"></script>

      <!--mensajes emergentes-->
    {% if messages %}
      {% for message in messages %}
      <script>
          Swal.fire({
              icon: "{% if message.tags == 'error' %}error{% elif message.tags == 'success' %}success{% elif message.tags == 'warning' %}warning{% else %}info{% endif %}",
              title: "{{ message|escapejs }}",
              confirmButtonText: "Aceptar",
              confirmButtonColor: "#3085d6",
              timer: 4000,
              timerProgressBar: true
          });
      </script>
      {% endfor %}
    {% endif %}

</body>
</html>

<!-- ------------------------------------------------------------------------------------------------------------
     ------------------------------------- FIN perfil_alumno .HTML ----------------------------------------------
     ------------------------------------------------------------------------------------------------------------ -->